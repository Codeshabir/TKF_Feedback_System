@{
    Layout = "~/Views/Shared/_Layout.cshtml";
}
<aside id="layout-menu" class="layout-menu menu-vertical menu bg-menu-theme">
    @*   <!-- Instruction Modal -->
    <div id="instructionModal" class="modal">
    <div class="modal-content">
    <span class="close" onclick="document.getElementById('instructionModal').style.display='none'">&times;</span>
    <h2>Task 1: Change Brand Logo</h2>
    <p>
    To complete Task 1, go to Views > Home > Index. In the `Index.cshtml` file, find the keyword for the brand logo and upload the necessary image.
    </p>
    <button onclick="handleLogoUpload();">Close</button>
    </div>
    </div>

    <!-- Congrats Modal -->
    <div id="congratsModal" class="modal">
    <div class="modal-content">
    <span class="close" onclick="document.getElementById('congratsModal').style.display='none'">&times;</span>
    <h2>Congratulations!</h2>
    <p>You have successfully completed Task 1. You earned 50 marks!</p>
    <button onclick="document.getElementById('congratsModal').style.display='none'">Close</button>
    </div>
    </div>

    *@



    <!-- Your existing code -->
    <!-- Task 1 Instruction Modal -->
    @*<div id="instructionModal" class="modal">
    <div class="modal-content">
    <span class="close" onclick="document.getElementById('instructionModal').style.display='none'">&times;</span>
    <h2>Task 1: Change Brand Logo</h2>
    <p>
    To complete Task 1, go to Views > Home > Index. In the `Index.cshtml` file, find the keyword for the brand logo and upload the necessary image.
    </p>
    <button onclick="handleLogoUpload();">Close</button>
    </div>
    </div>

    <!-- Congrats Modal for Task 1 -->
    <div id="congratsModalTask1" class="modal">
    <div class="modal-content">
    <span class="close" onclick="document.getElementById('congratsModalTask1').style.display='none'">&times;</span>
    <h2>Congratulations!</h2>
    <p>You have successfully completed Task 1. You earned 50 marks!</p>
    <button onclick="document.getElementById('congratsModalTask1').style.display='none'; checkTask2();">Close</button>
    </div>
    </div>

    <!-- Task 2 Instruction Modal -->
    <div id="task2InstructionModal" class="modal">
    <div class="modal-content">
    <span class="close" onclick="document.getElementById('task2InstructionModal').style.display='none'">&times;</span>
    <h2>Task 2: Redirect View Complaint Button</h2>
    <p>
    To complete Task 2, go to the file where the "View Complaint" button is defined. Update the URL to redirect to the Client Information tab and display the list of complaints.
    </p>
    <button onclick="handleRedirectTask();">Close</button>
    </div>
    </div>

    <!-- Congrats Modal for Task 2 -->
    <div id="congratsModalTask2" class="modal">
    <div class="modal-content">
    <span class="close" onclick="document.getElementById('congratsModalTask2').style.display='none'">&times;</span>
    <h2>Congratulations!</h2>
    <p>You have successfully completed Task 2. You earned 50 marks!</p>
    <button onclick="document.getElementById('congratsModalTask2').style.display='none'">Close</button>
    </div>
    </div>
    *@
    <!-- Your existing logo HTML -->
    <div class="app-brand demo">
        <a href="/" class="app-brand-link">
            <span class="app-brand-logo demo">
                <!-- Add an id to easily target the logo in JavaScript -->
                @*                            <img id="appBrandLogo" src="/assets/img/avatars/1.png" alt="Brand Logo">
                *@
            </span>
            <span class="app-brand-text demo menu-text fw-bolder ms-2">TKF - Admin</span>
        </a>

        <a href="javascript:void(0);" class="layout-menu-toggle menu-link text-large ms-auto d-block d-xl-none">
            <i class="bx bx-chevron-left bx-sm align-middle"></i>
        </a>
    </div>


    <div class="menu-inner-shadow"></div>

    <ul class="menu-inner py-1">
        <!-- Dashboard -->
        <li class="menu-item active">
            <a href="/" class="menu-link">
                <i class="menu-icon tf-icons bx bx-home-circle"></i>
                <div data-i18n="Analytics">Dashboard</div>
            </a>
        </li>



        <li class="menu-item">
            <a href="@Url.Action("Index","ClientInformationView")" class="menu-link">
                <i class="menu-icon tf-icons bx bx-table"></i>
                <div data-i18n="Tables">Client Information</div>
            </a>
        </li>
        @*     <li class="menu-item">
        <a href="project-table.html" class="menu-link">
        <i class="menu-icon tf-icons bx bx-table"></i>
        <div data-i18n="Tables">Projects</div>
        </a>
        </li>*@
        <li class="menu-item">
            <a href="@Url.Action("Index","FeedbackView")" class="menu-link">
                <i class="menu-icon tf-icons bx bx-table"></i>
                <div data-i18n="Tables">Feedback </div>
            </a>
        </li>

    </ul>
</aside>

<div class="container-xxl flex-grow-1 container-p-y">

    <div class="row">
        <div class="col-lg-8 mb-4 order-0">
            <div class="card">
                <div class="d-flex align-items-end row">
                    <div class="col-sm-7">
                        <div class="card-body">
                            <h5 class="card-title text-primary">Welcome! to CRM Dashboard🎉</h5>
                            <p class="mb-4">
                                Check your new Complaints in
                                your profile.
                            </p>

                            <a href="@Url.Action("Index","ClientInformationView")" class="btn btn-sm btn-outline-primary">View Complaints</a>
                        </div>
                    </div>
                    <div class="col-sm-5 text-center text-sm-left">
                        <div class="card-body pb-0 px-0 px-md-4">
                            <img src="../assets/img/illustrations/man-with-laptop-light.png"
                                 height="140"
                                 alt="View Badge User"
                                 data-app-dark-img="illustrations/man-with-laptop-dark.png"
                                 data-app-light-img="illustrations/man-with-laptop-light.png" />
                        </div>
                    </div>
                </div>
            </div>
        </div>
        <div class="col-lg-4 col-md-4 order-1">
            <div class="row">
                <div class="col-lg-6 col-md-12 col-6 mb-4">
                    <div class="card">
                        <div class="card-body">
                            <div class="card-title d-flex align-items-start justify-content-between">
                                <div class="avatar flex-shrink-0">
                                    <img src="../assets/img/icons/unicons/chart-success.png"
                                         alt="chart success"
                                         class="rounded" />
                                </div>
                                <div class="dropdown">
                                    <button class="btn p-0"
                                            type="button"
                                            id="cardOpt3"
                                            data-bs-toggle="dropdown"
                                            aria-haspopup="true"
                                            aria-expanded="false">
                                        <i class="bx bx-dots-vertical-rounded"></i>
                                    </button>
                                    <div class="dropdown-menu dropdown-menu-end" aria-labelledby="cardOpt3">
                                        <a class="dropdown-item" href="javascript:void(0);">View More</a>
                                        <a class="dropdown-item" href="javascript:void(0);">Delete</a>
                                    </div>
                                </div>
                            </div>
                            <span class="fw-semibold d-block mb-1">Received</span>

                            @if (ViewBag.StatusTotals.ContainsKey("Received"))
                            {
                                <h3 class="card-title mb-2">@ViewBag.StatusTotals["Received"]</h3>
                                <small class="text-success fw-semibold"><i class="bx bx-up-arrow-alt"></i> +72.80%</small>
                            }
                       
                           
                        </div>
                    </div>
                </div>
                <div class="col-lg-6 col-md-12 col-6 mb-4">
                    <div class="card">
                        <div class="card-body">
                            <div class="card-title d-flex align-items-start justify-content-between">
                                <div class="avatar flex-shrink-0">
                                    <img src="../assets/img/icons/unicons/wallet-info.png"
                                         alt="Credit Card"
                                         class="rounded" />
                                </div>
                                <div class="dropdown">
                                    <button class="btn p-0"
                                            type="button"
                                            id="cardOpt6"
                                            data-bs-toggle="dropdown"
                                            aria-haspopup="true"
                                            aria-expanded="false">
                                        <i class="bx bx-dots-vertical-rounded"></i>
                                    </button>
                                    <div class="dropdown-menu dropdown-menu-end" aria-labelledby="cardOpt6">
                                        <a class="dropdown-item" href="javascript:void(0);">View More</a>
                                        <a class="dropdown-item" href="javascript:void(0);">Delete</a>
                                    </div>
                                </div>
                            </div>
                            <span>In Progress</span>

                            @if (ViewBag.StatusTotals.ContainsKey("InProgress"))
                            {
                                <h3 class="card-title text-nowrap mb-1">@ViewBag.StatusTotals["InProgress"]</h3>
                                <small class="text-success fw-semibold"><i class="bx bx-up-arrow-alt"></i> +28.42%</small>
                            }

                        </div>
                    </div>
                </div>
            </div>
        </div>
        <!-- Total Revenue -->
        <div class="col-12 col-lg-8 order-2 order-md-3 order-lg-2 mb-4">
            <div class="card">
                <div class="row row-bordered g-0">
                    <div class="col-md-8">
                        <h5 class="card-header m-0 me-2 pb-3">Total Complaints</h5>
                        <div id="complaintChart" class="px-2"></div>
                    </div>
                    <div class="col-md-4">
                        <div class="card-body">
                            <div class="text-center">
                                <div class="dropdown">
                                    <button class="btn btn-sm btn-outline-primary dropdown-toggle"
                                            type="button"
                                            id="growthReportId"
                                            data-bs-toggle="dropdown"
                                            aria-haspopup="true"
                                            aria-expanded="false">
                                        2023
                                    </button>
                                    <div class="dropdown-menu dropdown-menu-end" aria-labelledby="growthReportId">
                                        <a class="dropdown-item" href="javascript:void(0);">2023</a>
                                        <a class="dropdown-item" href="javascript:void(0);">2022</a>
                                        <a class="dropdown-item" href="javascript:void(0);">2021</a>
                                    </div>
                                </div>
                            </div>
                        </div>
                        <div id="growthChart"></div>
                        <div class="text-center fw-semibold pt-3 mb-2">62% Growth</div>

                        <div class="d-flex px-xxl-4 px-lg-2 p-4 gap-xxl-3 gap-lg-1 gap-3 justify-content-between">
                            <div class="d-flex">
                                <div class="me-2">
                                    <span class="badge bg-label-primary p-2"><i class="bx bx-dollar text-primary"></i></span>
                                </div>
                                <div class="d-flex flex-column">
                                    <small>2023</small>
                                    <h6 class="mb-0">32.5k</h6>
                                </div>
                            </div>
                            <div class="d-flex">
                                <div class="me-2">
                                    <span class="badge bg-label-info p-2"><i class="bx bx-wallet text-info"></i></span>
                                </div>
                                <div class="d-flex flex-column">
                                    <small>2022</small>
                                    <h6 class="mb-0">41.2k</h6>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>

            </div>
        </div>
        <!--/ Total Revenue -->
        <div class="col-12 col-md-8 col-lg-4 order-3 order-md-2">
            <div class="row">
                <div class="col-6 mb-4">
                    <div class="card">
                        <div class="card-body">
                            <div class="card-title d-flex align-items-start justify-content-between">
                                <div class="avatar flex-shrink-0">
                                    <img src="../assets/img/icons/unicons/cc-warning.png" alt="User" class="rounded" />
                                </div>
                                <div class="dropdown">
                                    <button class="btn p-0"
                                            type="button"
                                            id="cardOpt4"
                                            data-bs-toggle="dropdown"
                                            aria-haspopup="true"
                                            aria-expanded="false">
                                        <i class="bx bx-dots-vertical-rounded"></i>
                                    </button>
                                    <div class="dropdown-menu dropdown-menu-end" aria-labelledby="cardOpt4">
                                        <a class="dropdown-item" href="javascript:void(0);">View More</a>
                                        <a class="dropdown-item" href="javascript:void(0);">Delete</a>
                                    </div>
                                </div>
                            </div>

                            <span class="d-block mb-1">Rejected</span>

                            @if (ViewBag.StatusTotals.ContainsKey("Rejected"))
                            {
                             
                                <h3 class="card-title text-nowrap mb-2">@ViewBag.StatusTotals["Rejected"]</h3>
                                <small class="text-danger fw-semibold"><i class="bx bx-down-arrow-alt"></i> -14.82%</small>
                            }
                        </div>
                    </div>
                </div>
                <div class="col-6 mb-4">
                    <div class="card">
                        <div class="card-body">
                            <div class="card-title d-flex align-items-start justify-content-between">
                                <div class="avatar flex-shrink-0">
                                    <img src="../assets/img/icons/unicons/cc-primary.png" alt="Credit Card" class="rounded" />
                                </div>
                                <div class="dropdown">
                                    <button class="btn p-0"
                                            type="button"
                                            id="cardOpt1"
                                            data-bs-toggle="dropdown"
                                            aria-haspopup="true"
                                            aria-expanded="false">
                                        <i class="bx bx-dots-vertical-rounded"></i>
                                    </button>
                                    <div class="dropdown-menu" aria-labelledby="cardOpt1">
                                        <a class="dropdown-item" href="javascript:void(0);">View More</a>
                                        <a class="dropdown-item" href="javascript:void(0);">Delete</a>
                                    </div>
                                </div>
                            </div>
                            <span class="fw-semibold d-block mb-1">Responded</span>

                            @if (ViewBag.StatusTotals.ContainsKey("Responded"))
                            {
                                <h3 class="card-title mb-2">@ViewBag.StatusTotals["Responded"]</h3>
                                <small class="text-success fw-semibold"><i class="bx bx-up-arrow-alt"></i> +28.14%</small>

                            }

                        </div>
                    </div>
                </div>
                <!-- </div>
                <div class="row"> -->
                <div class="col-12 mb-4">
                    <div class="card">
                        <div class="card-body">
                            <div class="d-flex justify-content-between flex-sm-row flex-column gap-3">
                                <div class="d-flex flex-sm-column flex-row align-items-start justify-content-between">
                                    <div class="card-title">


                                       


                                        <h5 class="text-nowrap mb-2">Closed</h5>
                                        <span class="badge bg-label-warning rounded-pill">Year 2021</span>
                                    </div>
                                    <div class="mt-sm-auto">

                                        @if (ViewBag.StatusTotals.ContainsKey("Closed"))
                                        {
                                            <small class="text-success text-nowrap fw-semibold"><i class="bx bx-chevron-up"></i> 68.2%</small>
                                            <h3 class="mb-0">@ViewBag.StatusTotals["Closed"]</h3>
                                        }
                                    </div>
                                </div>
                                <div id="profileReportChart"></div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>
    <div class="row">
        <!-- Order Statistics -->
        <div class="col-md-6 col-lg-4 col-xl-4 order-0 mb-4">
            <div class="card h-100">
                <div class="card-header d-flex align-items-center justify-content-between pb-0">
                    <div class="card-title mb-0">
                        <h5 class="m-0 me-2">Complaint Type</h5>
                    </div>
                   @* <div class="dropdown">
                        <button class="btn p-0"
                                type="button"
                                id="orederStatistics"
                                data-bs-toggle="dropdown"
                                aria-haspopup="true"
                                aria-expanded="false">
                            <i class="bx bx-dots-vertical-rounded"></i>
                        </button>
                        <div class="dropdown-menu dropdown-menu-end" aria-labelledby="orederStatistics">
                            <a class="dropdown-item" href="javascript:void(0);">Select All</a>
                            <a class="dropdown-item" href="javascript:void(0);">Refresh</a>
                            <a class="dropdown-item" href="javascript:void(0);">Share</a>
                        </div>
                    </div>*@
                </div>
                <div class="card-body">
                    <div class="d-flex justify-content-between align-items-center mb-3">
                        <div class="d-flex flex-column align-items-center gap-1">
                            <h2 class="mb-2">8,258</h2>
                            <span>Total Complaints</span>
                        </div>
                        <div id="orderStatisticsChart"></div>
                    </div>
                    <ul class="p-0 m-0">
                        @foreach (var complaintTypeTotal in ViewBag.ComplaintTypeTotals)
                        {
                            <li class="d-flex mb-4 pb-1">
                                <div class="avatar flex-shrink-0 me-3">
                                    <span class="avatar-initial rounded bg-label-primary">
                                        <i class="bx bx-mobile-alt"></i>
                                    </span>
                                </div>
                                <div class="d-flex w-100 flex-wrap align-items-center justify-content-between gap-2">
                                    <div class="me-2">
                                        <h6 class="mb-0">@complaintTypeTotal.Key</h6>
                                    </div>
                                    <div class="user-progress">
                                        <small class="fw-semibold">@complaintTypeTotal.Value</small>
                                    </div>
                                </div>
                            </li>
                        }
                    </ul>
                </div>
            </div>
        </div>
        <!--/ Order Statistics -->
        <!-- Expense Overview -->
        <div class="col-md-6 col-lg-4 order-1 mb-4">
            <div class="card h-100">
                <div class="card-header">
                    <ul class="nav nav-pills" role="tablist">
                        <li class="nav-item">
                            <button type="button"
                                    class="nav-link active"
                                    role="tab"
                                    data-bs-toggle="tab"
                                    data-bs-target="#navs-tabs-line-card-income"
                                    aria-controls="navs-tabs-line-card-income"
                                    aria-selected="true">
                                Feedback
                            </button>
                        </li>
                    @*    <li class="nav-item">
                            <button type="button" class="nav-link" role="tab">Expenses</button>
                        </li>
                        <li class="nav-item">
                            <button type="button" class="nav-link" role="tab">Profit</button>
                        </li>*@
                    </ul>
                </div>
                <div class="card-body px-0">
                    <div class="tab-content p-0">
                        <div class="tab-pane fade show active" id="navs-tabs-line-card-income" role="tabpanel">
                            <div class="d-flex p-4 pt-3">
                                <div class="avatar flex-shrink-0 me-3">
                                    <img src="../assets/img/icons/unicons/wallet.png" alt="User" />
                                </div>
                                <div>
                                    <small class="text-muted d-block">Total Feedback</small>
                                    <div class="d-flex align-items-center">
                                        <h6 class="mb-0 me-1">459</h6>
                                        <small class="text-success fw-semibold">
                                            <i class="bx bx-chevron-up"></i>
                                            42.9%
                                        </small>
                                    </div>
                                </div>
                            </div>
                            <div id="incomeChart"></div>
                            <div class="d-flex justify-content-center pt-4 gap-2">
                                <div class="flex-shrink-0">
                                    <div id="expensesOfWeek"></div>
                                </div>
                                <div>
@*                                    <p class="mb-n1 mt-1">Expenses This Week</p>
*@                                    <small class="text-muted">39 less than last week</small>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
        <!--/ Expense Overview -->
        <!-- Transactions -->
        <div class="col-md-6 col-lg-4 order-2 mb-4">
            <div class="card h-100">
                <div class="card-header d-flex align-items-center justify-content-between">
                    <h5 class="card-title m-0 me-2">Project Wise Complaints</h5>
                    <div class="dropdown">
                        <button class="btn p-0"
                                type="button"
                                id="transactionID"
                                data-bs-toggle="dropdown"
                                aria-haspopup="true"
                                aria-expanded="false">
                            <i class="bx bx-dots-vertical-rounded"></i>
                        </button>
                        <div class="dropdown-menu dropdown-menu-end" aria-labelledby="transactionID">
                            <a class="dropdown-item" href="javascript:void(0);">Last 28 Days</a>
                            <a class="dropdown-item" href="javascript:void(0);">Last Month</a>
                            <a class="dropdown-item" href="javascript:void(0);">Last Year</a>
                        </div>
                    </div>
                </div>
                <div class="card-body">
                    <ul class="p-0 m-0">
                        @foreach (var projectTotal in ViewBag.ProjectTotals)
                        {
                            <li class="d-flex mb-4 pb-1">
                                <div class="avatar flex-shrink-0 me-3">
                                    <img src="../assets/img/icons/unicons/cc-warning.png" alt="User" class="rounded" />
                                </div>
                                <div class="d-flex w-100 flex-wrap align-items-center justify-content-between gap-2">
                                    <div class="me-2">
                                        <a class="dropdown-item project-option" data-project="@projectTotal.Key" href="javascript:void(0);" onclick="selectProject('@projectTotal.Key')">@projectTotal.Key</a>
                                    </div>
                                    <div class="user-progress d-flex align-items-center gap-1">
                                        <h6 class="mb-0">+@projectTotal.Value</h6>
                                    </div>
                                </div>
                            </li>
                        }
                    </ul>
                </div>
            </div>
        </div>
        <!--/ Transactions -->
    </div>
</div>


<script>
    debugger
    var complaintTypeTotals = @Html.Raw(Newtonsoft.Json.JsonConvert.SerializeObject(ViewBag.ComplaintTypeTotals));


</script>
<script>
    debugger
    @{
        var complaintTypes = ViewBag.ComplaintTypes;
    }

    @complaintTypes
   
    var complaintTypes = @Html.Raw(Newtonsoft.Json.JsonConvert.SerializeObject(ViewBag.ComplaintTypes));

    function selectProject(selectedProject) {
        console.log("Selected Project: " + selectedProject);
        var projectName = selectedProject;

        $.ajax({
            url: "/Home/SelectedProjGraph/",
            type: "GET",
            data: { projectName: projectName }, 
            success: function () {
                debugger;
                alert("Feedback updated successfully.");
                var complaintTypeTotals = complaintTypes


                initializeComplaintChart();
         
                //cation.reload(); // Reload the page
            },
            error: function (xhr, status, error) {
                alert("Error: " + error);
            }
        });
    }


</script>
<!-- Add this at the end of your HTML body tag -->
<!-- Add this at the end of your HTML body tag -->





<script src="~/js/chartvalues.js"></script>